<!-- services/control-plane/templates/base.html -->
<!DOCTYPE html>
<html lang="zh-TW" class="h-full bg-gray-50">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{.Title}} - Control Plane</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <script src="https://unpkg.com/htmx.org/dist/ext/ws.js"></script>

  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>

  <!-- Tom Select -->
  <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Custom CSS -->
  <style>
    /* 自定義樣式 */
    .sidebar-active {
      background: linear-gradient(90deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
      border-left: 3px solid rgb(99, 102, 241);
    }

    /* HTMX 載入動畫 */
    .htmx-indicator {
      display: none;
    }

    .htmx-request .htmx-indicator {
      display: inline-block;
    }

    .htmx-request.htmx-indicator {
      display: inline-block;
    }

    /* 過渡動畫 */
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body class="h-full">
  <div class="min-h-full flex" x-data="{ sidebarOpen: false, userMenuOpen: false }">
    <!-- 側邊欄 -->
    <nav class="w-64 bg-white shadow-lg fixed inset-y-0 left-0 z-40 transform transition-transform duration-300"
      :class="{ '-translate-x-full lg:translate-x-0': !sidebarOpen, 'translate-x-0': sidebarOpen }">
      <div class="flex flex-col h-full">
        <!-- Logo -->
        <div class="flex items-center justify-between h-16 px-6 border-b">
          <div class="flex items-center">
            <i data-lucide="activity" class="w-8 h-8 text-indigo-600"></i>
            <span class="ml-2 text-xl font-bold">Control Plane</span>
          </div>
          <button @click="sidebarOpen = false" class="lg:hidden">
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>

        <!-- 導航選單 -->
        <div class="flex-1 overflow-y-auto py-4">
          <nav class="px-3">
            <a href="/" class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 {{if eq .Page "
              dashboard"}}sidebar-active{{end}}">
              <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>
              <span>總覽儀表板</span>
            </a>
            <a href="/resources"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              resources"}}sidebar-active{{end}}">
              <i data-lucide="server" class="w-5 h-5 mr-3"></i>
              <span>資源管理</span>
            </a>
            <a href="/personnel"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              personnel"}}sidebar-active{{end}}">
              <i data-lucide="users" class="w-5 h-5 mr-3"></i>
              <span>組織與權限</span>
            </a>
            <a href="/teams"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              teams"}}sidebar-active{{end}}">
              <i data-lucide="users-2" class="w-5 h-5 mr-3"></i>
              <span>團隊管理</span>
            </a>
            <a href="/alerts"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              alerts"}}sidebar-active{{end}}">
              <i data-lucide="bell" class="w-5 h-5 mr-3"></i>
              <span>告警規則</span>
            </a>
            <a href="/automation"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              automation"}}sidebar-active{{end}}">
              <i data-lucide="zap" class="w-5 h-5 mr-3"></i>
              <span>自動化</span>
            </a>
            <a href="/capacity"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              capacity"}}sidebar-active{{end}}">
              <i data-lucide="trending-up" class="w-5 h-5 mr-3"></i>
              <span>容量規劃</span>
            </a>
            <a href="/incidents"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              incidents"}}sidebar-active{{end}}">
              <i data-lucide="alert-circle" class="w-5 h-5 mr-3"></i>
              <span>告警紀錄</span>
            </a>
            <a href="/channels"
              class="sidebar-item flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 mt-1 {{if eq .Page "
              channels"}}sidebar-active{{end}}">
              <i data-lucide="send" class="w-5 h-5 mr-3"></i>
              <span>通知管道</span>
            </a>